<script runat="server">
Platform.Load("Core","1.1.1");
try{
}
</script>

%%[
SET @subscriberkey= _subscriberkey

IF NOT EMPTY(@subscriberkey) THEN

SET @subscriberId =lookup("_subscribers", "SubscriberId", "SubscriberKey", @subscriberkey)


if not Empty(@subscriberId)  then

set @subscriberRows=LookupRows("_EnterpriseAttribute","_SubscriberID",@subscriberId)
set @prefcenterRows=LookupRows("prefcenter","subscriberkey", @subscriberkey)
if RowCount(@subscriberRows) ==1 and RowCount(@prefcenterRows) ==1 then


set @subscriberRow=Row(@subscriberRows,1)
set @firstName=Field(@subscriberRow, "first name", 0) 
set @lastName=Field(@subscriberRow, "last name", 0) 
set @email=Field(@subscriberRow, "email", 0) 

set @prefcenterRow=Row(@prefcenterRows,1)
set @newsletter=Field(@prefcenterRow, "newsletter", 0) 
/* set @events=Field(@prefcenterRow, "events", 0) 
set @offers=Field(@prefcenterRow, "offers", 0)  */
else

endif 
endif 
endif  
 ]%%
  <div>%%=v(@subscriberId)=%%</div>
  <div>%%=v(@firstName)=%%</div>
   <div>%%=v(@lastName)=%%</div>
   <div>%%=v(@email)=%%</div>
   <div>%%=v(@newsletter)=%%</div>
   <div>%%=v(@events)=%%</div>
   <div>%%=v(@offers)=%%</div>
<script runat="server">
}
catch(e) {
 Variable.SetValue("errorMessage", "msg: " + Stringify(e.message) + Stringify(e.description));
}
</script>


<script runat="client">
console.log(`%%=v(@errorMessage)=%%`);
console.log('<ctrl:var name="myVar" />');
</script>