<script runat="server">
Platform.Load("Core","1.1.1");
try{


</script>

%%[
  SET @subscriberkey= _subscriberkey

IF NOT EMPTY(@subscriberkey) THEN

  SET @subscriberId =lookup("_subscribers", "SubscriberId", "SubscriberKey", @subscriberkey)


  if not Empty(@subscriberId)  then

set @subscriberRows=LookupRows("_EnterpriseAttribute","_SubscriberID",@subscriberId)

if RowCount(@subscriberRows) >0 then


set @subscriberRow=Row(@subscriberRows,1)
set @firstName=Field(@subscriberRow, "first name", 0) 
set @lastName=Field(@subscriberRow, "last name", 0) 
set @email=Field(@subscriberRow, "email", 0) 

SET @subscriberRows = RetrieveSalesforceObjects(
   "Contact",
   "Id,FirstName,LastName,Email,Newsletter__c,Events__c,Offers__c,HasOptedOutOfEmail",
   "Id", "=", @subscriberkey
   )
else
set @firstName="nodata" 
endif 
endif 
endif  
 ]%%
  <div>%%=v(@subscriberId)=%%</div>
  <div>%%=v(@firstName)=%%</div>
   <div>%%=v(@lastName)=%%</div>
   <div>%%=v(@email)=%%</div>
<script runat="server">
}
catch(e) {
 Variable.SetValue("errorMessage", "msg: " + Stringify(e.message) + Stringify(e.description));
}
</script>


<script runat="client">
console.log(`%%=v(@errorMessage)=%%`);
console.log('<ctrl:var name="myVar" />');
</script>